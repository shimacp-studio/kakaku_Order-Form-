<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ã‚·ãƒã‚³ãƒ¼ãƒãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ç™ºæ³¨ã‚«ã‚¿ãƒ­ã‚°</title>
<style>
:root {
  --ink:#0f172a;--muted:#64748b;--line:#e5e7eb;
  --bg:#f6f8ff;--card:#fff;--brand:#1e66ff;
  --accent:#155eef;--shadow:0 4px 16px rgba(16,24,40,.06);
}
*{box-sizing:border-box}
html,body{
  margin:0;background:var(--bg);color:var(--ink);
  font-family:"Noto Sans JP",system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif
}
h1{margin:0;font-weight:800}

/* === TOPãƒšãƒ¼ã‚¸ï¼ˆãƒ’ãƒ¼ãƒ­ãƒ¼ï¼‰ === */
#topPage{
  position:fixed;
  inset:0;
  z-index:9999;
  display:flex;
  align-items:flex-start;
  justify-content:center;
  height:100dvh;
  width:100%;
  background:#f3f4f6;
  padding:24px 0;
  box-sizing:border-box;
  transition:opacity .4s ease;
  opacity:1;
}
.top-shell{
  width:100%;
  max-width:1200px;
  margin:0 auto;
  background:#ffffff;
  border-radius:28px;
  box-shadow:0 18px 45px rgba(15,23,42,.20);
  padding:20px 32px 32px;
  display:flex;
  flex-direction:column;
  gap:20px;
}

/* ä¸Šã®ãƒãƒ¼ï¼ˆãƒ­ã‚´ï¼‹ã‚¿ã‚¤ãƒˆãƒ«ï¼‰ */
.top-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:16px;
  padding-bottom:10px;
  border-bottom:15px solid #9ca3af;
}
.top-brand{
  display:flex;
  align-items:center;
  gap:10px;
}
.top-logo{
  width:40px;
  height:40px;
  border-radius:12px;
  box-shadow:0 4px 12px rgba(15,23,42,.25);
  object-fit:cover;
}
.top-brand-text{
  font-weight:800;
  letter-spacing:.08em;
  font-size:14px;
  color:#111827;
}
.top-ship{
  font-size:12px;
  color:#6b7280;
}

/* ä¸‹å´ï¼šãƒ’ãƒ¼ãƒ­ãƒ¼ï¼ˆèƒŒæ™¯ï¼‹å·¦ã‚³ãƒ”ãƒ¼ï¼‹å³ãƒ•ã‚©ãƒ¼ãƒ ï¼‰ */
.top-hero-row{
  position:relative;
  margin-top:16px;
}
.top-hero{
  position:relative;
  width:100%;
  height:420px;
  border-radius:22px;
  overflow:hidden;
  background:#ffffff;
}
.top-hero::before{
  content:"";
  position:absolute;
  inset:0;
  background-image:url("img/shima_owl.jpg");
  background-repeat:no-repeat;
  background-position:center center;
  background-size:min(60%, 420px);
  opacity:0.18;
  filter:saturate(115%) contrast(110%);
  pointer-events:none;
  z-index:0;
}
.top-hero::after{
  content:"";
  position:absolute;
  inset:0;
  background:linear-gradient(
    180deg,
    rgba(0,0,0,0.05) 0%,
    rgba(0,0,0,0.00) 40%,
    rgba(0,0,0,0.12) 100%
  );
  pointer-events:none;
  z-index:0;
}
.top-hero-copy,
.top-card{
  position:relative;
  z-index:1;
}
.top-hero-copy{
  position:absolute;
  left:56px;
  top:50%;
  transform:translateY(-50%);
  max-width:520px;
  font-size:32px;
  line-height:1.5;
  color:#111827;
  font-weight:800;
}
.top-hero-sub{
  font-size:14px;
  font-weight:500;
  opacity:.8;
}

/* å³å´ãƒ•ã‚©ãƒ¼ãƒ ã‚«ãƒ¼ãƒ‰ï¼ˆPCãƒ»ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆï¼‰ */
.top-card{
  position:absolute;
  right:56px;
  top:50%;
  transform:translateY(-50%);
  width:320px;
  max-width:38%;
  padding:20px 20px 22px;
  background:rgba(255,255,255,0.88);
  border-radius:18px;
  box-shadow:0 20px 45px rgba(15,23,42,0.55);
  backdrop-filter:blur(18px);
  -webkit-backdrop-filter:blur(18px);
  text-align:left;
}
.top-eyebrow{
  font-size:11px;
  letter-spacing:.18em;
  font-weight:700;
  color:#9ca3af;
  margin:0 0 6px;
}
.top-card h1{
  font-size:18px;
  line-height:1.6;
  font-weight:800;
  color:#111827;
  margin:0 0 8px;
}
.top-lead{
  margin:0 0 14px;
  font-size:13px;
  color:#6b7280;
}

/* å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆç¸¦ä¸¦ã³ï¼‰ */
.top-form{
  display:flex;
  flex-direction:column;
  gap:10px;
}
.autowrap{
  position:relative;
  width:100%;
}
.top-input{
  width:100%;
  border-radius:999px;
  padding:10px 16px;
  font-size:14px;
  color:#0f172a;
  background:rgba(248,250,252,0.95);
  border:1px solid rgba(148,163,184,0.8);
  box-shadow:0 8px 22px rgba(15,23,42,0.22);
  outline:none;
  -webkit-appearance:none;
  appearance:none;
}
.top-input::placeholder{
  color:#9ca3af;
}
.top-input:focus{
  border-color:#2563eb;
  box-shadow:
    0 0 0 1px rgba(37,99,235,0.9),
    0 16px 34px rgba(37,99,235,0.55);
}
.top-input:-webkit-autofill{
  -webkit-box-shadow:0 0 0 1000px rgba(248,250,252,0.95) inset !important;
          box-shadow:0 0 0 1000px rgba(248,250,252,0.95) inset !important;
  -webkit-text-fill-color:#0f172a !important;
}
.top-start-btn{
  margin-top:8px;
  width:100%;
  background:linear-gradient(135deg,#2563eb,#1d4ed8);
  border-color:#1d4ed8;
  font-size:14px;
  padding:11px 18px;
}
.top-start-btn:hover{
  transform:translateY(-1px);
  box-shadow:0 8px 18px rgba(37,99,235,.35);
}

/* === ã‚¹ãƒãƒ›ãƒ»ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆï¼ˆãƒ­ã‚´ç”»åƒãƒ•ãƒ«èƒŒæ™¯ãƒ»ã‚«ãƒ¼ãƒ‰ãªã—ï¼‰ === */
@media (max-width:900px){
  html,body{
    background:#020617;
  }
  #topPage{
    padding:0;
    align-items:flex-start;
    justify-content:center;
    background:#020617;
  }
  .top-shell{
    width:100%;
    max-width:none;
    margin:0;
    padding:0 0 16px;
    border-radius:0;
    box-shadow:none;
    background:#020617;
  }
  .top-header{
    padding:12px 16px 10px;
    border-bottom:none;
    background:#020617;
  }
  .top-brand-text{
    font-size:13px;
    line-height:1.3;
    color:#f9fafb;
  }
  .top-ship{
    font-size:11px;
    color:#9ca3af;
  }
  .top-hero-row{
    margin-top:0;
  }
  .top-hero{
    position:relative;
    min-height:calc(100dvh - 70px);
    border-radius:0;
    padding:40px 18px 28px;
    background:url("img/shima_owl.jpg") center / cover no-repeat;
    background-color:#000;
  }
  .top-hero::before{
    content:"";
    position:absolute;
    inset:0;
    pointer-events:none;
    background:linear-gradient(
      to bottom,
      rgba(0,0,0,0.40) 0%,
      rgba(0,0,0,0.10) 35%,
      rgba(0,0,0,0.65) 100%
    );
  }
  .top-hero::after{
    content:none;
  }
  .top-hero-copy{
    position:static;
    transform:none;
    max-width:100%;
    margin:0 0 20px;
    font-size:22px;
    line-height:1.5;
    font-weight:800;
    color:#f9fafb;
    text-shadow:0 4px 18px rgba(0,0,0,0.9);
  }
  .top-hero-sub{
    display:block;
    margin-top:6px;
    font-size:13px;
    color:#e5e7eb;
  }
  .top-card{
    position:static;
    transform:none;
    width:100%;
    max-width:420px;
    margin:0 auto;
    padding:0;
    background:transparent;
    border-radius:0;
    box-shadow:none;
    backdrop-filter:none;
    -webkit-backdrop-filter:none;
    text-align:left;
  }
  .top-eyebrow{
    font-size:11px;
    letter-spacing:.18em;
    color:#e5e7eb;
    text-shadow:0 2px 6px rgba(0,0,0,0.7);
  }
  .top-card h1{
    font-size:16px;
    line-height:1.5;
    color:#f9fafb;
    text-shadow:0 2px 8px rgba(0,0,0,0.8);
  }
  .top-lead{
    font-size:12px;
    color:#e5e7eb;
    opacity:0.9;
  }
  .top-input{
    background:rgba(248,250,252,0.97);
    border-color:rgba(148,163,184,0.9);
    box-shadow:0 10px 30px rgba(15,23,42,0.7);
  }
  .top-start-btn{
    width:100%;
    font-size:14px;
    padding:11px 16px;
  }
}

/* === ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆç™ºæ³¨ã‚«ã‚¿ãƒ­ã‚°ç”»é¢ï¼‰ ================== */
header:not(.top-header){
  position:sticky;
  top:0;
  z-index:30;
  background:radial-gradient(circle at top, #020617 0, #020617 55%, #000 100%);
  border-bottom:1px solid rgba(148,163,184,.5);
  box-shadow:0 26px 80px rgba(0,0,0,.96);
}
.wrap{
  max-width:1200px;
  margin:0 auto;
  padding:16px 32px;
  min-height:80px;
  display:flex;
  align-items:center;
  gap:28px;
}
.brand{
  display:flex;
  align-items:center;
  gap:12px;
  white-space:nowrap;
}
.brand img{
  width:44px;
  height:44px;
  border-radius:14px;
  box-shadow:0 18px 45px rgba(0,0,0,0.9);
}
.brand h1{
  font-size:16px;
  letter-spacing:.25em;
  text-transform:uppercase;
  font-weight:800;
  color:#f9fafb;
}
.search-wrap{
  flex:1;
  display:flex;
  justify-content:center;
}
.search-box{
  position:relative;
  display:flex;
  align-items:center;
  width:100%;
  max-width:720px;
  background:#020617;
  border-radius:999px;
  border:1px solid #334155;
  box-shadow:
    0 0 0 1px rgba(15,23,42,0.9),
    0 24px 70px rgba(0,0,0,0.9);
  overflow:hidden;
}
.search-box:focus-within{
  border-color:#60a5fa;
  box-shadow:
    0 0 0 1px #60a5fa,
    0 30px 80px rgba(37,99,235,0.85);
}
.search-box input{
  flex:1;
  border:none;
  outline:none;
  background:transparent;
  color:#e5e7eb;
  font-size:14px;
  padding:14px 16px 14px 44px;
}
.search-box input::placeholder{
  color:#9ca3af;
}
.search-icon{
  position:absolute;
  left:14px;
  font-size:13px;
  color:#9ca3af;
  pointer-events:none;
}
.search-btn{
  border:none;
  background:linear-gradient(135deg,#2563eb,#1d4ed8);
  color:#f9fafb;
  font-size:11px;
  font-weight:700;
  letter-spacing:.14em;
  text-transform:uppercase;
  padding:0 24px;
  cursor:pointer;
  height:100%;
  display:inline-flex;
  align-items:center;
  justify-content:center;
}
.search-btn:hover{
  background:linear-gradient(135deg,#3b82f6,#1d4ed8);
}
.actions{
  display:flex;
  align-items:center;
  gap:14px;
}
.btn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:6px;
  padding:0 18px;
  min-height:42px;
  border-radius:999px;
  border:1px solid #374151;
  background:#111827;
  color:#f9fafb;
  font-size:11px;
  font-weight:700;
  letter-spacing:.10em;
  text-transform:uppercase;
  cursor:pointer;
  box-shadow:0 12px 30px rgba(0,0,0,0.6);
  transition:
    transform .12s ease,
    box-shadow .12s ease,
    background .12s ease,
    border-color .12s ease,
    opacity .12s ease;
}
.btn:hover{
  transform:translateY(-1px);
  box-shadow:0 20px 40px rgba(0,0,0,0.8);
  background:#1f2937;
}
.btn:active{
  transform:translateY(0);
  box-shadow:0 9px 22px rgba(0,0,0,0.65);
}
.btn:disabled{
  opacity:.55;
  cursor:not-allowed;
  box-shadow:none;
}

/* ã‚«ãƒ¼ãƒˆã‚¢ã‚¤ã‚³ãƒ³ */
.cart-toggle{
  position:relative;
  border:none;
  background:transparent;
  padding:0;
  cursor:pointer;
}
.cart-toggle img{
  width:56px;
  height:56px;
  padding:0;
  border-radius:0;
  background:transparent !important;
  border:none !important;
  box-shadow:none !important;
  display:block;
}
.cart-toggle:hover img{
  transform:translateY(-1px) scale(1.03);
}
.cart-badge{
  position:absolute;
  top:-4px;
  right:-4px;
  min-width:22px;
  height:22px;
  padding:0 7px;
  border-radius:999px;
  background:#f97316;
  color:#111827;
  font-size:11px;
  font-weight:800;
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow:0 0 0 2px #020617;
}
.cart-badge.is-empty{
  display:none;
}

/* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¸¯ï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰ */
.order-marquee{
  background:#020617;
  border-bottom:1px solid #111827;
  overflow:hidden;
  white-space:nowrap;
}
.order-marquee-inner{
  max-width:1200px;
  margin:0 auto;
  padding:14px 32px;
  position:relative;
}
.order-marquee-track{
  display:inline-flex;
  align-items:center;
  gap:48px;
  animation:orderMarquee 22s linear infinite;
}
.order-marquee-badge{
  padding:4px 16px;
  border-radius:999px;
  border:1px solid #64748b;
  font-size:12px;
  letter-spacing:.22em;
  text-transform:uppercase;
  color:#f9fafb;
}
.order-marquee-text{
  font-size:16px;
  font-weight:800;
  color:#ffffff;
  letter-spacing:.04em;
}
.order-marquee-dot{
  font-size:20px;
  color:#e5e7eb;
}
@keyframes orderMarquee{
  0%{transform:translateX(0);}
  100%{transform:translateX(-50%);}
}
@media print{
  .order-marquee{display:none!important;}
}

/* å¹…ãŒç‹­ã„ã¨ãã®ãƒ˜ãƒƒãƒ€ãƒ¼èª¿æ•´ */
@media (max-width:960px){
  .wrap{
    padding-inline:16px;
    gap:10px;
  }
  .brand h1{
    font-size:12px;
    letter-spacing:.16em;
  }
  .search-box{
    max-width:100%;
  }
}

/* === ç™ºæ³¨ç”»é¢ï¼šãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ä¼æ¥­ï¼ç¾å ´åã‚¨ãƒªã‚¢ ====================== */
.order-meta{
  max-width:1200px;
  margin:10px auto 0;
  padding:0 32px;
}
.order-meta-inner{
  display:flex;
  flex-wrap:wrap;
  gap:12px;
  align-items:flex-end;
}
.meta-field{
  flex:1;
  min-width:220px;
}
.meta-field label{
  display:block;
  margin-bottom:4px;
  font-size:11px;
  font-weight:600;
  letter-spacing:.08em;
  text-transform:uppercase;
  color:#9ca3af;
}
.meta-input{
  width:100%;
  padding:8px 12px;
  border-radius:999px;
  border:1px solid #4b5563;
  background:#020617;
  color:#e5e7eb;
  font-size:13px;
}
.meta-input::placeholder{
  color:#6b7280;
}
@media (max-width:960px){
  .order-meta{
    padding:0 16px;
  }
}
@media print{
  .order-meta{
    display:none !important;
  }
}

/* ===== ç™ºæ³¨ã‚«ã‚¿ãƒ­ã‚°æœ¬ä½“ ===== */
main{
  max-width:1200px;
  margin:28px auto 56px;
  padding:24px 32px 48px;
  background:radial-gradient(circle at top, #111827 0, #020617 55%, #020617 100%);
  border-radius:28px;
  box-shadow:0 30px 80px rgba(0,0,0,0.85);
}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill, minmax(260px, 1fr));
  gap:24px 20px;
}
.card{
  position:relative;
  display:flex;
  flex-direction:column;
  background:transparent;
  border-radius:0;
  border:none;
  box-shadow:none;
  padding:4px 4px 18px;
  transition:
    transform .14s ease,
    box-shadow .14s ease;
}
.card:hover{
  transform:translateY(-2px);
  box-shadow:0 16px 40px rgba(0,0,0,0.45);
}
.thumb{
  width:100%;
  aspect-ratio:4 / 3;
  background:#f9fafb;
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
  border-radius:16px;
  border:1px solid #e5e7eb33;
}
.thumb img{
  width:86%;
  max-height:86%;
  object-fit:contain;
  display:block;
  background:#f9fafb;
}
.body{
  padding:10px 2px 6px;
  display:flex;
  flex-direction:column;
  gap:6px;
}
.title{
  font-size:13px;
  font-weight:700;
  line-height:1.5;
  color:#e5e7eb;
  display:-webkit-box;
  -webkit-line-clamp:2;
  -webkit-box-orient:vertical;
  overflow:hidden;
  min-height:3em;
}
.price-row{
  margin-top:4px;
  display:flex;
  align-items:baseline;
  gap:6px;
}
.price-main{
  font-size:16px;
  font-weight:800;
  color:#fbbf24;
}
.price-sub{
  font-size:11px;
  color:#9ca3af;
}
.price{
  font-size:13px;
  font-weight:700;
  color:#e5e7eb;
}
.barcode{
  margin-top:4px;
  font-size:11px;
  color:#9ca3af;
  font-family:"SF Mono","Consolas","Menlo",monospace;
  letter-spacing:.08em;
  text-align:left;
}
.barcode-text{display:block;}
.barcode-svg{display:none;}
.actions-card{
  display:flex;
  align-items:center;
  gap:8px;
  margin-top:8px;
  padding:0;
  border-top:none;
  background:transparent;
}
.qtyinput{
  flex:0 0 86px;
  padding:6px 8px;
  border-radius:999px;
  border:1px solid #4b5563;
  background:#020617;
  color:#e5e7eb;
  font-size:13px;
  text-align:center;
}
.qtyinput::placeholder{
  color:#6b7280;
}
.actions-card .btn{
  flex:1;
  font-size:11px;
  padding:8px 10px;
  background:#fbbf24;
  color:#111827;
  border-color:#fbbf24;
  box-shadow:0 10px 26px rgba(0,0,0,0.7);
}
.actions-card .btn:hover{
  background:#facc15;
  border-color:#facc15;
}

/* ã‚«ãƒ¼ãƒˆãƒ‘ãƒãƒ« */
.cart{
  position:fixed;
  top:96px;
  right:28px;
  width:320px;
  max-height:calc(100dvh - 160px);
  display:flex;
  flex-direction:column;
  gap:10px;
  padding:14px 16px 14px;
  background:#020617;
  border-radius:20px;
  border:1px solid #1f2937;
  box-shadow:0 26px 72px rgba(0,0,0,0.95);
  color:#e5e7eb;
  z-index:60;
  transform:translateX(110%);
  opacity:0;
  pointer-events:none;
  transition:transform .25s ease, opacity .25s ease;
}
.cart.open{
  transform:translateX(0);
  opacity:1;
  pointer-events:auto;
}
.cart h2{
  margin:0 0 4px;
  font-size:12px;
  letter-spacing:.16em;
  text-transform:uppercase;
  color:#9ca3af;
}
.cartlist{
  flex:1;
  overflow:auto;
  padding-right:2px;
  font-size:12px;
}
.cartitem{
  display:grid;
  grid-template-columns:1fr auto auto;
  gap:6px;
  padding:6px 0;
  border-bottom:1px solid #111827;
}
.cartitem:last-child{
  border-bottom:none;
}
.cartitem div:nth-child(1){
  font-weight:500;
}
.cartitem div:nth-child(2),
.cartitem div:nth-child(3){
  text-align:right;
  font-variant-numeric:tabular-nums;
  color:#d1d5db;
}
.cart-summary{
  font-size:12px;
}
.cart-summary strong{
  font-weight:700;
}
.cart .btn{
  width:100%;
  margin-top:6px;
}

/* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ï¼ˆç™ºæ³¨ç”»é¢ï¼‰ */
@media (max-width:960px){
  main{
    margin:18px auto 40px;
    padding:16px 16px 32px;
    border-radius:0;
  }
  .grid{
    gap:22px 14px;
  }
  .cart{
    top:84px;
    right:12px;
    width:min(340px, calc(100% - 24px));
  }
}

/* === ç™ºæ³¨ç”»é¢ï¼šèƒŒæ™¯ã‚’åè»¢ï¼ˆå¤–ï¼šé»’ï¼ä¸­ï¼šã‚°ãƒ¬ãƒ¼ï¼‰ ================= */
@media screen{
  body{
    background:#020617;
  }
  main{
    background:#f3f4f6;
    border-radius:28px;
    box-shadow:0 24px 60px rgba(0,0,0,0.85);
  }
  .title{
    color:#111827;
  }
  .price{
    color:#111827;
  }
  .price-sub{
    color:#6b7280;
  }
  .barcode svg rect[fill='#000']{
    fill:#111827;
  }
  .qtyinput{
    background:#ffffff;
    color:#111827;
    border:1px solid #d1d5db;
  }
  .actions-card .btn{
    box-shadow:0 8px 18px rgba(0,0,0,0.25);
  }
}

/* === å°åˆ·è¨­å®š === */
@page{
  size:A4 portrait;
  margin:8mm 8mm 18mm 8mm;
}
.header-print,
.footer-print{
  display:none;
}
@media print{
  #topPage,
  header,
  .actions,
  .cart,
  .actions-card,
  .controls{
    display:none !important;
  }
  .header-print{display:flex !important;}
  .footer-print{display:block !important;}

  html,
  body{
    background:#ffffff !important;
    counter-reset:item;
    position:relative !important;
    box-shadow:none !important;
  }
  main,
  .grid,
  .card,
  .body,
  .thumb{
    background:#ffffff !important;
    box-shadow:none !important;
    border-radius:0 !important;
  }
  main{
    display:block !important;
    margin:0;
    padding:0;
    position:relative !important;
    min-height:245mm !important;
  }
  .grid{
    grid-template-columns:repeat(2,1fr) !important;
    gap:6mm;
    width:calc(210mm - 20mm);
    margin:30mm auto 0;
  }
  .card{
    display:flex !important;
    position:relative;
    flex-direction:row;
    align-items:flex-start;
    gap:4mm;
    border:1px solid #d9e1f2;
    padding:3.5mm;
    height:calc((297mm - 95mm) / 5);
    page-break-inside:avoid;
    overflow:hidden;
  }
  .card::before{
    counter-increment:item;
    content:"No." counter(item);
    position:absolute;
    bottom:1.8mm;
    right:2.2mm;
    padding:1.4mm 3mm;
    font-family:"Orbitron","Segoe UI","Noto Sans JP",sans-serif;
    font-weight:700;
    font-size:7.3pt;
    color:#fff;
    background:linear-gradient(135deg,#0ea5e9 0%,#2563eb 50%,#1e3a8a 100%);
    border-radius:12px;
  }
  .thumb{
    flex:0 0 33mm;
    height:auto;
    display:flex;
    align-items:center;
    justify-content:center;
    border:none;
  }
  .thumb img{
    max-height:27mm;
    max-width:100%;
    object-fit:contain;
  }
  .body{
    flex:1;
    display:flex;
    flex-direction:column;
    justify-content:flex-start;
    gap:2mm;
    padding-right:3mm;
  }
  .title{
    font-size:9.3pt !important;
    line-height:1.4 !important;
    max-height:22mm !important;
    overflow:hidden !important;
    white-space:normal !important;
    word-break:break-word !important;
    font-weight:700 !important;
  }
  .barcode{
    margin-top:0;
    text-align:left;
  }
  .barcode-text{
    display:none !important;
  }
  .barcode-svg{
    display:inline-block !important;
  }
  .barcode-svg svg{
    height:20px;
    width:70px;
  }
  .price{font-size:9.3pt;}
  .qty-print,
  .print-only{
    display:flex !important;
  }
  .qty-print{
    position:absolute !important;
    bottom:3mm !important;
    left:4mm !important;
    align-items:center;
    gap:1.2mm;
    font-size:9pt;
    font-weight:600;
  }
  .qty-print input{
    width:20mm !important;
    height:6mm !important;
    border:1px solid #bbb;
    border-radius:3mm;
    padding:0 2mm;
    background:#fff;
    outline:none;
  }
  .header-print{
    position:fixed;
    top:5mm;
    left:0;
    width:100%;
    display:flex;
    align-items:center;
    justify-content:center;
    gap:8px;
    background:#ffffff !important;
    background-image:none !important;
    box-shadow:none !important;
    border-bottom:none !important;
  }
  .header-print img{
    height:14mm;
    width:auto;
  }
  .header-print h2{
    font-size:16pt;
    font-weight:800;
    margin:0;
  }
  .footer-print{
    position:fixed !important;
    bottom:0mm !important;
    left:0;
    width:100%;
    text-align:center;
    font-size:11pt;
    font-family:"Noto Sans JP","Segoe UI",sans-serif;
    color:#0f172a;
    padding-top:2mm;
    background:#ffffff !important;
    z-index:9999;
  }
}

/* ã‚ªãƒ¼ãƒˆã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆå€™è£œ */
.autolist{
  position:absolute;
  left:0;
  top:100%;
  margin-top:4px;
  width:100%;
  background:#ffffff;
  border:none;
  border-radius:8px;
  box-shadow:0 8px 16px rgba(15,23,42,0.12);
  max-height:180px;
  overflow-y:auto;
  font-size:14px;
  z-index:50;
}
.autolist:empty{
  border:0;
}
.autolist div{
  padding:6px 10px;
  cursor:pointer;
}
.autolist div:hover{
  background:#e0edff;
}
</style>
</head>
<body>

<!-- === TOPãƒšãƒ¼ã‚¸ï¼ˆãƒ’ãƒ¼ãƒ­ãƒ¼ï¼‰ === -->
<div id="topPage">
  <div class="top-shell">
    <header class="top-header">
      <div class="top-brand">
        <img src="img/shima_owl.jpg" alt="ã‚·ãƒã‚³ãƒ¼ãƒãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ­ã‚´" class="top-logo">
        <span class="top-brand-text">
          ã‚·ãƒã‚³ãƒ¼ãƒãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³<br>ç™ºæ³¨ã‚«ã‚¿ãƒ­ã‚°
        </span>
      </div>
      <div class="top-ship">ç¾å ´ã‹ã‚‰ã‚«ãƒ³ã‚¿ãƒ³ Web ç™ºæ³¨</div>
    </header>

    <div class="top-hero-row">
      <div class="top-hero">
        <p class="top-hero-copy">
          å¿…è¦ãªæ¶ˆè€—å“ã‚’ã€<br>
          ã„ã¤ã‚‚ã®ç¾å ´ã‹ã‚‰ã¾ã¨ã‚ã¦æ³¨æ–‡ã€‚<br>
          <span class="top-hero-sub">
            ã‚¹ãƒãƒ›ã²ã¨ã¤ã§ã€ç™ºæ³¨æ¼ã‚Œã‚¼ãƒ­ã¸ã€‚
          </span>
        </p>

        <div class="top-card">
          <p class="top-eyebrow">ORDER FORM</p>
          <h1>ç™ºæ³¨æƒ…å ±ã‚’å…¥åŠ›ã—ã¦<br>ã‚«ã‚¿ãƒ­ã‚°ã‚’é–‹ã„ã¦ãã ã•ã„</h1>
          <p class="top-lead">
            ä¸€åº¦å…¥åŠ›ã™ã‚‹ã¨ã€æ¬¡å›ã‹ã‚‰å±¥æ­´ã¨ã—ã¦è‡ªå‹•å€™è£œã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
          </p>
          <div class="top-form">
            <div class="autowrap">
              <input id="buyerName" class="top-input" placeholder="ç™ºæ³¨è€…å" autocomplete="off">
            </div>
            <button id="startBtn" class="btn top-start-btn">
              ç™ºæ³¨ã‚«ã‚¿ãƒ­ã‚°ã‚’é–‹ã
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- === ç™ºæ³¨ã‚«ã‚¿ãƒ­ã‚°ç”»é¢ === -->
<header>
  <div class="wrap">
    <div class="brand">
      <img src="img/shima_owl.jpg" alt="logo">
      <h1>ã‚·ãƒã‚³ãƒ¼ãƒãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ç™ºæ³¨ã‚«ã‚¿ãƒ­ã‚°</h1>
    </div>
    <div class="search-wrap">
      <div class="search-box">
        <span class="search-icon">ğŸ”</span>
        <input id="productSearch" type="search"
               placeholder="ã“ã“ã«å•†å“åãƒ»JANã‚’å…¥åŠ›ã—ã¦æ¤œç´¢"
               autocomplete="off">
        <button id="searchBtn" class="search-btn" type="button">æ¤œç´¢</button>
      </div>
    </div>
    <div class="actions">
      <button id="cartToggle" class="cart-toggle" type="button">
        <img src="img/KART.png" alt="ã‚«ãƒ¼ãƒˆ">
        <span id="cartBadge" class="cart-badge is-empty">0</span>
      </button>
      <button class="btn" onclick="window.print()">å°åˆ·ï¼ˆA4ç¸¦ï¼‰</button>
    </div>
  </div>
</header>

<div class="order-marquee">
  <div class="order-marquee-inner">
    <div class="order-marquee-track">
      <span class="order-marquee-badge">SHIMA ORDER MESSAGE</span>
      <span class="order-marquee-text">
        ä¸€ã¤ã²ã¨ã¤ã®ç¾å ´ã«ã€ã¡ã‚‡ã†ã©ã„ã„æ¶ˆè€—å“ã‚’ã€‚
      </span>
      <span class="order-marquee-dot">â€”</span>
      <span class="order-marquee-text">
        æœˆï¼‘å›ã®ã€Œã¾ã¨ã‚ç™ºæ³¨ã€ã§ã€ã‚¹ãƒˆãƒƒã‚¯åˆ‡ã‚Œã‚¼ãƒ­ã¸ã€‚
      </span>
      <span class="order-marquee-dot">â€”</span>
      <span class="order-marquee-text">
        ã‚«ã‚¿ãƒ­ã‚°ã‹ã‚‰é¸ã¶ã ã‘ã€‚ãƒ¬ã‚¸å‰ã§ã®ç™ºæ³¨ãƒ¡ãƒ¢ã¯ã‚‚ã†ä¸è¦ã§ã™ã€‚
      </span>
      <span class="order-marquee-badge">SHIMA ORDER MESSAGE</span>
      <span class="order-marquee-text">
        ä¸€ã¤ã²ã¨ã¤ã®ç¾å ´ã«ã€ã¡ã‚‡ã†ã©ã„ã„æ¶ˆè€—å“ã‚’ã€‚
      </span>
      <span class="order-marquee-dot">â€”</span>
      <span class="order-marquee-text">
        æœˆï¼‘å›ã®ã€Œã¾ã¨ã‚ç™ºæ³¨ã€ã§ã€ã‚¹ãƒˆãƒƒã‚¯åˆ‡ã‚Œã‚¼ãƒ­ã¸ã€‚
      </span>
      <span class="order-marquee-dot">â€”</span>
      <span class="order-marquee-text">
        ã‚«ã‚¿ãƒ­ã‚°ã‹ã‚‰é¸ã¶ã ã‘ã€‚ãƒ¬ã‚¸å‰ã§ã®ç™ºæ³¨ãƒ¡ãƒ¢ã¯ã‚‚ã†ä¸è¦ã§ã™ã€‚
      </span>
    </div>
  </div>
</div>

<main>
  <section class="order-meta">
    <div class="order-meta-inner">
      <div class="meta-field">
        <label for="partnerName">ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ä¼æ¥­ï¼ˆä»»æ„ï¼‰</label>
        <input id="partnerName" class="meta-input"
               placeholder="ä¾‹ï¼šã€‡ã€‡å»ºè¨­" autocomplete="off">
      </div>
      <div class="meta-field">
        <label for="siteName">ç¾å ´åï¼ˆä»»æ„ï¼‰</label>
        <input id="siteName" class="meta-input"
               placeholder="ä¾‹ï¼šâ–³â–³ãƒ“ãƒ«æ–°ç¯‰å·¥äº‹" autocomplete="off">
      </div>
    </div>
  </section>

  <section><div id="grid" class="grid"></div></section>

  <aside class="cart">
    <h2>ã‚«ãƒ¼ãƒˆ</h2>
    <div id="cartlist" class="cartlist"></div>
    <div class="cart-summary">
      <strong>å°è¨ˆï¼š</strong><span id="subtotal">0å††</span><br>
      <strong>ç¨è¾¼ï¼š</strong><span id="total">0å††</span>
    </div>
    <button id="orderBtn" class="btn">ã“ã®å†…å®¹ã§ç™ºæ³¨ï¼ˆãƒ¡ãƒ¼ãƒ«é€ä¿¡ï¼‰</button>
  </aside>
</main>

<div class="header-print">
  <img src="img/shima_owl.jpg" alt="logo">
  <h2>ã‚·ãƒã‚³ãƒ¼ãƒãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ç™ºæ³¨ã‚«ã‚¿ãƒ­ã‚°</h2>
</div>
<div class="footer-print">
  ç™ºæ³¨è€…åï¼šï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ã€€æ—¥ä»˜ï¼šï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ã€€å‚™è€ƒï¼šï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿
</div>

<script>
function enableAutoComplete(inputId){
  const input = document.getElementById(inputId);
  const list = document.createElement("div");
  list.className = "autolist";
  input.parentNode.appendChild(list);
  const saved = JSON.parse(localStorage.getItem("history_" + inputId) || "[]");
  input.addEventListener("input", () => { showList(input, list, saved); });
  input.addEventListener("focus", () => { showList(input, list, saved); });
  input.addEventListener("change", () => {
    const val = input.value.trim();
    if (!val) return;
    if (!saved.includes(val)) {
      saved.unshift(val);
      if (saved.length > 20) saved.pop();
      localStorage.setItem("history_" + inputId, JSON.stringify(saved));
    }
  });
  document.addEventListener("click", e => {
    if (!list.contains(e.target) && e.target !== input) list.innerHTML = "";
  });
}
function showList(input, list, saved){
  const val = input.value.trim();
  list.innerHTML = "";
  const matches = val ? saved.filter(v => v.includes(val)) : saved;
  matches.forEach(m => {
    const item = document.createElement("div");
    item.textContent = m;
    item.onclick = () => {
      input.value = m;
      list.innerHTML = "";
    };
    list.appendChild(item);
  });
}

console.log("âœ… script loaded");
const GAS_ENDPOINT = "https://script.google.com/macros/s/AKfycbxGz8VCT8IkE_8nPOX7vVh-CMGkpOVPsnIhbO-FEViWKcP6KAapatDeusREagPta62kuA/exec";
let cart = [];

function startFlow(){
  const buyer = (document.getElementById("buyerName")?.value || "").trim();
  if (!buyer){
    alert("ç™ºæ³¨è€…åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
    return;
  }
  sessionStorage.setItem("buyerName", buyer);
  sessionStorage.setItem("partnerName", (document.getElementById("partnerName")?.value || "").trim());
  sessionStorage.setItem("siteName", (document.getElementById("siteName")?.value || "").trim());
  const topPage = document.getElementById("topPage");
  const mainEl  = document.querySelector("main");
  if (topPage){
    topPage.style.opacity = "0";
    topPage.style.pointerEvents = "none";
    setTimeout(() => {
      topPage.style.display = "none";
      topPage.style.visibility = "hidden";
      topPage.style.zIndex = "-1";
    }, 350);
  }
  if (mainEl){
    mainEl.style.display   = "block";
    mainEl.style.visibility= "visible";
    mainEl.style.opacity   = "1";
    mainEl.style.position  = "relative";
    mainEl.style.zIndex    = "10";
  }
  try{ boot(); }
  catch(e){
    console.error("boot() error:", e);
    alert("å•†å“æç”»ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’ã”ç¢ºèªãã ã•ã„ã€‚");
  }
}
function bindStartButton(){
  const btn = document.getElementById("startBtn");
  if (btn) btn.addEventListener("click", startFlow);
  ["buyerName","partnerName","siteName"].forEach(id => {
    const el = document.getElementById(id);
    if (el) el.addEventListener("keydown", ev => { if (ev.key === "Enter") startFlow(); });
  });
}
document.addEventListener("click", ev => {
  const hit = ev.target.closest?.("#startBtn");
  if (hit) startFlow();
});
(function(){
  const style = document.createElement("style");
  style.textContent = ".top-hero::before, .top-hero::after { pointer-events:none !important; } .top-hero, .top-card, .top-form, .top-input, #startBtn { pointer-events:auto !important; }";
  document.head.appendChild(style);
})();

window.addEventListener("DOMContentLoaded", () => {
  console.log("âœ… DOM Ready");
  ["buyerName","partnerName","siteName"].forEach(id => {
    const el = document.getElementById(id);
    if (el) el.value = "";
  });
  ["buyerName","partnerName","siteName"].forEach(id => {
    try{ enableAutoComplete(id); }catch(_){}
  });
  bindStartButton();

  const orderBtn = document.getElementById("orderBtn");
  if (orderBtn) orderBtn.onclick = sendOrder;

  const cartToggle = document.getElementById("cartToggle");
  const cartPanel  = document.querySelector(".cart");
  if (cartToggle && cartPanel){
    cartToggle.addEventListener("click", () => {
      if (!cart.length){
        alert("ã‚«ãƒ¼ãƒˆã«å•†å“ãŒã‚ã‚Šã¾ã›ã‚“");
        return;
      }
      cartPanel.classList.toggle("open");
    });
  }

  const searchInput = document.getElementById("productSearch");
  const searchBtn   = document.getElementById("searchBtn");
  if (searchInput){
    searchInput.addEventListener("input", applySearchFilter);
    searchInput.addEventListener("keydown", ev => {
      if (ev.key === "Enter") applySearchFilter();
    });
  }
  if (searchBtn){
    searchBtn.addEventListener("click", applySearchFilter);
  }
});

/* ã‚«ãƒ¼ãƒˆè¡¨ç¤ºæ›´æ–° */
function updateCart(){
  const list  = document.getElementById("cartlist");
  const badge = document.getElementById("cartBadge");
  list.innerHTML = "";
  if (!cart.length){
    list.textContent = "ã‚«ãƒ¼ãƒˆã¯ç©ºã§ã™";
    document.getElementById("subtotal").textContent = "0å††";
    document.getElementById("total").textContent    = "0å††";
    if (badge){
      badge.textContent = "0";
      badge.classList.add("is-empty");
    }
    return;
  }
  let subtotal = 0;
  cart.forEach((it,i) => {
    subtotal += it.price * it.qty;
    list.insertAdjacentHTML("beforeend",
      "<div class='cartitem'>" +
        "<div>" + it.name + "</div>" +
        "<div>" + it.qty + "</div>" +
        "<div>" + (it.price * it.qty).toLocaleString() + "å††</div>" +
        "<button onclick='removeItem(" + i + ")' style='color:red;border:none;background:none;font-weight:800'>Ã—</button>" +
      "</div>"
    );
  });
  document.getElementById("subtotal").textContent = subtotal.toLocaleString() + "å††";
  document.getElementById("total").textContent    = Math.round(subtotal * 1.1).toLocaleString() + "å††";
  if (badge){
    const totalQty = cart.reduce((sum,it) => sum + it.qty, 0);
    if (totalQty > 0){
      badge.textContent = totalQty;
      badge.classList.remove("is-empty");
    }else{
      badge.textContent = "0";
      badge.classList.add("is-empty");
    }
  }
}

/* æ¤œç´¢ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ */
function applySearchFilter(){
  const input = document.getElementById("productSearch");
  const grid  = document.getElementById("grid");
  if (!input || !grid) return;
  const q = input.value.trim().toLowerCase();
  const cards = grid.querySelectorAll(".card");
  if (!q){
    cards.forEach(c => c.style.display = "");
    return;
  }
  cards.forEach(card => {
    const text = card.textContent.toLowerCase();
    card.style.display = text.includes(q) ? "" : "none";
  });
}
function removeItem(i){
  cart.splice(i,1);
  updateCart();
}

/* å•†å“æç”» */
async function boot(){
  const PRODUCTS = await fetch("products.json", { cache:"no-store" })
    .then(r => { if (!r.ok) throw new Error("products.jsonãŒèª­ã¿è¾¼ã‚ã¾ã›ã‚“ã§ã—ãŸ"); return r.json(); })
    .catch(err => {
      console.error(err);
      alert("âš ï¸ å•†å“ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚products.jsonã®é…ç½®ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚");
      return [];
    });
  const grid = document.getElementById("grid");
  grid.innerHTML = "";
  PRODUCTS.forEach(p => {
    const jan   = String(p.jan ?? "");
    const name  = String(p.name ?? "");
    const price = Number(p.price ?? 0);
    const barcodeText = jan ? "JAN: " + jan : "";
    const barcodeSvg  = jan ? (renderBarcode(jan) || "") : "";
    grid.insertAdjacentHTML("beforeend",
      "<div class='card'>" +
        "<div class='thumb'>" +
          "<img src='img/" + jan + ".jpg' onerror="this.onerror=null;this.src='img/noimage.jpg'">" +
        "</div>" +
        "<div class='body'>" +
          "<div class='title'>" + name + "</div>" +
          "<div class='price-row'>" +
            "<span class='price-main'>ï¿¥" + Math.round(price * 1.1).toLocaleString() + "</span>" +
            "<span class='price-sub'>ï¼ˆç¨æŠœ ï¿¥" + price.toLocaleString() + "ï¼‰</span>" +
          "</div>" +
          "<div class='barcode'>" +
            "<span class='barcode-text'>" + barcodeText + "</span>" +
            "<span class='barcode-svg'>" + barcodeSvg + "</span>" +
          "</div>" +
        "</div>" +
        "<div class='qty-print print-only' style='display:none'>" +
          "<label style='margin-right:4px;'>æ•°é‡</label>" +
          "<input id='print-qty-" + jan + "' type='text' inputmode='numeric' pattern='[0-9ï¼-ï¼™]*' aria-label='å°åˆ·ç”¨æ•°é‡'>" +
        "</div>" +
        "<div class='actions-card'>" +
          "<input id='qty-" + jan + "' type='number' class='qtyinput' min='0' step='1' placeholder='æ•°é‡'>" +
          "<button class='btn' type='button' onclick='addToCart({jan:"" + jan + "",name:"" + name.replace("'","\'") + "",price:" + price + "})'>ã‚«ãƒ¼ãƒˆã«è¿½åŠ </button>" +
        "</div>" +
      "</div>"
    );
  });
}

/* ã‚«ãƒ¼ãƒˆæ“ä½œ */
function addToCart(p){
  const qEl = document.getElementById("qty-" + p.jan);
  if (!qEl) return;
  const q = Number(qEl.value);
  if (!q || q <= 0) return;
  const ex = cart.find(x => x.jan === p.jan);
  if (ex){
    ex.qty += q;
  }else{
    cart.push({ jan:p.jan, name:p.name, price:p.price, qty:q });
  }
  updateCart();
  qEl.value = "";
}

/* é€ä¿¡ */
async function sendOrder(){
  if (!cart.length){
    alert("ã‚«ãƒ¼ãƒˆãŒç©ºã§ã™");
    return;
  }
  const buyer = (document.getElementById("buyerName")?.value || "").trim();
  if (!buyer){
    alert("ç™ºæ³¨è€…åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
    return;
  }
  const partner = (document.getElementById("partnerName")?.value || "").trim();
  const site    = (document.getElementById("siteName")?.value || "").trim();
  const payload = {
    buyerName:buyer,
    partnerName:partner,
    siteName:site,
    items:cart.map(c => ({ jan:c.jan, name:c.name, price:c.price, qty:c.qty }))
  };
  const btn = document.getElementById("orderBtn");
  btn.disabled = true;
  btn.textContent = "é€ä¿¡ä¸­â€¦";
  try{
    await fetch(GAS_ENDPOINT,{
      method:"POST",
      mode:"no-cors",
      headers:{ "Content-Type":"application/json" },
      body:JSON.stringify(payload)
    });
    alert("âœ… ç™ºæ³¨ã‚’å—ã‘ä»˜ã‘ã¾ã—ãŸï¼ˆãƒ¡ãƒ¼ãƒ«é€ä¿¡æ¸ˆã¿ï¼‰");
    cart = [];
    updateCart();
    const topPage = document.getElementById("topPage");
    const mainEl  = document.querySelector("main");
    if (topPage && mainEl){
      mainEl.style.display = "none";
      mainEl.style.opacity = "0";
      mainEl.style.visibility = "hidden";
      mainEl.style.zIndex = "0";
      topPage.style.display = "flex";
      topPage.style.opacity = "1";
      topPage.style.visibility = "visible";
      topPage.style.zIndex = "9999";
      ["buyerName","partnerName","siteName"].forEach(id => {
        const el = document.getElementById(id);
        if (el) el.value = "";
      });
    }
  }catch(e){
    alert("âš ï¸ é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸï¼š" + e.message);
  }finally{
    btn.disabled = false;
    btn.textContent = "ã“ã®å†…å®¹ã§ç™ºæ³¨ï¼ˆãƒ¡ãƒ¼ãƒ«é€ä¿¡ï¼‰";
  }
}

/* ãƒãƒ¼ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ */
function ean13Pattern(d){
  const L=["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],
        G=["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"],
        R=["1110010","1100110","1101100","1000010","1011100","1001110","1010000","1000100","1001000","1110100"],
        P={"0":"LLLLLL","1":"LLGLGG","2":"LLGGLG","3":"LLGGGL","4":"LGLLGG","5":"LGGLLG","6":"LGGGLL","7":"LGLGLG","8":"LGLGGL","9":"LGGLGL"};
  const s=(d||"").replace(/[^0-9]/g,"");
  if(s.length<12) return null;
  const d12=s.slice(0,12),
        cd=(10-((d12.split("").reduce((a,b,i)=>a+Number(b)*(i%2?3:1),0))%10))%10;
  const first=d12[0], left=d12.slice(1,7), right=d12.slice(7,12)+cd;
  let bits="101", par=P[first];
  for(let i=0;i<6;i++){ bits+=(par[i]==="L"?L[left[i]]:G[left[i]]); }
  bits+="01010";
  for(let i=0;i<6;i++){ bits+=R[right[i]]; }
  return bits+"101";
}
function renderBarcode(jan){
  const bits=ean13Pattern(jan);
  if(!bits) return "";
  let out="<svg viewBox='0 0 " + bits.length + " 20' xmlns='http://www.w3.org/2000/svg' shape-rendering='crispEdges'><rect width='" + bits.length + "' height='20' fill='#fff'/>";
  for(let i=0;i<bits.length;i++) if(bits[i]==="1") out+="<rect x='" + i + "' y='0' width='1' height='18' fill='#000'/>";
  out+="</svg>";
  return out;
}
</script>

</body>
</html>
